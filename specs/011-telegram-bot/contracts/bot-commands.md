# Telegram Bot Commands Contract

**Feature**: 011-telegram-bot
**Date**: 2026-02-05

## Bot Commands

–ö–æ–º–∞–Ω–¥—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º—ã–µ —á–µ—Ä–µ–∑ BotFather.

### /start

**Description**: –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
**Behavior**:
- –°–æ–∑–¥–∞—ë—Ç TelegramUser (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `is_age_verified = true`
- –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é ChatSession (channel='telegram')
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å 3 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –≤–∏–Ω

**Flow**:
```
User ‚Üí /start
Bot  ‚Üê "–ü—Ä–∏–≤–µ—Ç! –Ø GetMyWine..."
     ‚Üê [Wine 1] —Å inline –∫–Ω–æ–ø–∫–∞–º–∏ [üëç] [üëé]
     ‚Üê [Wine 2] —Å inline –∫–Ω–æ–ø–∫–∞–º–∏ [üëç] [üëé]
     ‚Üê [Wine 3] —Å inline –∫–Ω–æ–ø–∫–∞–º–∏ [üëç] [üëé]
```

**Response Template**:
```
–ü—Ä–∏–≤–µ—Ç! üëã –Ø GetMyWine, –∏ —è –ø–æ–º–æ–≥—É –≤–∞–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –º–∏—Ä–µ –≤–∏–Ω–∞.

–í–æ—Ç —á—Ç–æ —è –ø–æ–¥–æ–±—Ä–∞–ª –¥–ª—è –≤–∞—Å —Å–µ–≥–æ–¥–Ω—è:

üç∑ *{wine_1.name}*
üìç {wine_1.region}, {wine_1.country}
üí∞ ~${wine_1.price}
{wine_1.recommendation_reason}

üç∑ *{wine_2.name}*
...

–ù–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ, —á—Ç–æ –≤—ã –∏—â–µ—Ç–µ! –ù–∞–ø—Ä–∏–º–µ—Ä:
‚Ä¢ "–í–∏–Ω–æ –∫ —Å—Ç–µ–π–∫—É"
‚Ä¢ "–õ—ë–≥–∫–æ–µ –±–µ–ª–æ–µ –Ω–∞ –≤–µ—á–µ—Ä"
‚Ä¢ "–ü–æ–¥–∞—Ä–æ–∫ –¥–ª—è –¥—Ä—É–≥–∞"
```

---

### /help

**Description**: –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
**Behavior**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ø—Ä–∞–≤–∫—É –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º –∫–æ–º–∞–Ω–¥–∞–º

**Response**:
```
üìö *–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*

/start ‚Äî –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
/help ‚Äî –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É
/profile ‚Äî –ü–æ–∫–∞–∑–∞—Ç—å –≤–∞—à –≤–∫—É—Å–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
/link ‚Äî –°–≤—è–∑–∞—Ç—å —Å –≤–µ–±-–∞–∫–∫–∞—É–Ω—Ç–æ–º

*–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:*
–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ, —á—Ç–æ –≤—ã –∏—â–µ—Ç–µ! –ù–∞–ø—Ä–∏–º–µ—Ä:
‚Ä¢ "–ü–æ—Ä–µ–∫–æ–º–µ–Ω–¥—É–π –∫—Ä–∞—Å–Ω–æ–µ –∫ –º—è—Å—É"
‚Ä¢ "–ß—Ç–æ-–Ω–∏–±—É–¥—å –∏–≥—Ä–∏—Å—Ç–æ–µ –¥–æ $50"
‚Ä¢ "–í–∏–Ω–æ –¥–ª—è —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–∂–∏–Ω–∞"

–Ø —É—á—Ç—É –≤–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–ª–æ–∂—É –ª—É—á—à–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞.
```

---

### /profile

**Description**: –ü–æ–∫–∞–∑–∞—Ç—å –≤–∫—É—Å–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
**Behavior**:
- –ï—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å –ø—É—Å—Ç–æ–π ‚Üí –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å
- –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–±–Ω–æ–≤–∏—Ç—å

**Response (empty profile)**:
```
üìä *–í–∞—à –≤–∫—É—Å–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–∫–∞ –ø—É—Å—Ç*

–ß—Ç–æ–±—ã —è –º–æ–≥ –¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–≤–æ–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è—Ö:

[–ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å]
```

**Response (with profile)**:
```
üìä *–í–∞—à –≤–∫—É—Å–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å:*

üç∑ –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–π —Ç–∏–ø: {wine_type}
üç¨ –°–ª–∞–¥–æ—Å—Ç—å: {sweetness}
‚ö° –ö–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å: {acidity}/5
üå∞ –¢–∞–Ω–∏–Ω—ã: {tannins}/5
üí∞ –ë—é–¥–∂–µ—Ç: –¥–æ ${budget}

üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ–ª—É—á–µ–Ω–æ: {total_recommendations}
‚Ä¢ –ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å: {liked_count}
‚Ä¢ –ù–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å: {disliked_count}

[–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å]
```

---

### /link

**Description**: –°–≤—è–∑–∞—Ç—å —Å –≤–µ–±-–∞–∫–∫–∞—É–Ω—Ç–æ–º
**Behavior**:
1. –ó–∞–ø—Ä–æ—Å–∏—Ç—å email
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞ email
3. –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∫–æ–¥ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –°–≤—è–∑–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã

**Flow**:
```
User ‚Üí /link
Bot  ‚Üê "–í–≤–µ–¥–∏—Ç–µ email –æ—Ç –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –≤–µ–±-–≤–µ—Ä—Å–∏–∏:"
User ‚Üí user@example.com
Bot  ‚Üê "–û—Ç–ø—Ä–∞–≤–∏–ª –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞ user@example.com. –í–≤–µ–¥–∏—Ç–µ –µ–≥–æ:"
User ‚Üí 123456
Bot  ‚Üê "‚úÖ –ê–∫–∫–∞—É–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å–≤—è–∑–∞–Ω—ã! –¢–µ–ø–µ—Ä—å –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω."
```

**Error Cases**:
- Email –Ω–µ –Ω–∞–π–¥–µ–Ω: "‚ùå –ê–∫–∫–∞—É–Ω—Ç —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Å–∞–π—Ç–µ."
- –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥: "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∏—Ç–µ –Ω–æ–≤—ã–π –∫–æ–º–∞–Ω–¥–æ–π /link"
- Email —É–∂–µ —Å–≤—è–∑–∞–Ω: "‚ÑπÔ∏è –≠—Ç–æ—Ç email —É–∂–µ —Å–≤—è–∑–∞–Ω —Å –¥—Ä—É–≥–∏–º Telegram-–∞–∫–∫–∞—É–Ω—Ç–æ–º."

---

## Inline Keyboards

### Wine Feedback

–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–¥ –∫–∞–∂–¥–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π –≤–∏–Ω–∞.

```python
InlineKeyboardMarkup([
    [
        InlineKeyboardButton("üëç", callback_data=f"like:{wine_id}"),
        InlineKeyboardButton("üëé", callback_data=f"dislike:{wine_id}"),
    ]
])
```

**Callback Handling**:
- `like:{wine_id}` ‚Üí –ó–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–∑—ã–≤, –æ–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞ "‚úÖ –°–ø–∞—Å–∏–±–æ!"
- `dislike:{wine_id}` ‚Üí –ó–∞–ø–∏—Å–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–∑—ã–≤, –æ–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞ "–£—á—Ç—ë–º!"

---

### Profile Edit

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è.

```python
# Sweetness selection
InlineKeyboardMarkup([
    [InlineKeyboardButton("–°—É—Ö–æ–µ", callback_data="pref:sweetness:dry")],
    [InlineKeyboardButton("–ü–æ–ª—É—Å—É—Ö–æ–µ", callback_data="pref:sweetness:semi_dry")],
    [InlineKeyboardButton("–ü–æ–ª—É—Å–ª–∞–¥–∫–æ–µ", callback_data="pref:sweetness:semi_sweet")],
    [InlineKeyboardButton("–°–ª–∞–¥–∫–æ–µ", callback_data="pref:sweetness:sweet")],
])

# Budget selection
InlineKeyboardMarkup([
    [InlineKeyboardButton("–î–æ $30", callback_data="pref:budget:30")],
    [InlineKeyboardButton("$30-100", callback_data="pref:budget:100")],
    [InlineKeyboardButton("$100+", callback_data="pref:budget:999")],
])
```

---

## Free-Text Message Handling

–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–µ —è–≤–ª—è—é—â–∏–µ—Å—è –∫–æ–º–∞–Ω–¥–∞–º–∏, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –∑–∞–ø—Ä–æ—Å—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

**Request Types** (auto-detected):

| Pattern | Detection | Response Type |
|---------|-----------|---------------|
| "–∫ —Å—Ç–µ–π–∫—É", "–∫ —Ä—ã–±–µ" | Food pairing | Wine + food match explanation |
| "—Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π", "–¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è" | Event | Wine + event context |
| "–¥–æ $50", "–Ω–µ–¥–æ—Ä–æ–≥–æ–µ" | Budget | Budget-filtered recommendations |
| "–∫—Ä–∞—Å–Ω–æ–µ", "–±–µ–ª–æ–µ", "–∏–≥—Ä–∏—Å—Ç–æ–µ" | Wine type | Type-filtered recommendations |
| Generic | - | General recommendation with context |

**Response Format**:
```
üç∑ *{wine.name}*
üìç {wine.region}, {wine.country}
üçá {wine.grape_varieties}

*–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:*
‚Ä¢ –°–ª–∞–¥–æ—Å—Ç—å: {sweetness_label}
‚Ä¢ –ö–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å: {'‚¨õ' * acidity}{'‚¨ú' * (5-acidity)}
‚Ä¢ –¢–∞–Ω–∏–Ω—ã: {'‚¨õ' * tannins}{'‚¨ú' * (5-tannins)}
‚Ä¢ –¢–µ–ª–æ: {'‚¨õ' * body}{'‚¨ú' * (5-body)}

üí∞ ~${wine.price}

*–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∏–Ω–æ:*
{recommendation_reason}

[üëç] [üëé]
```

---

## Error Messages

| Error | Message |
|-------|---------|
| LLM unavailable | "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å–µ—Ä–≤–∏—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç üîÑ" |
| No wines found | "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ –Ω–∞—à—ë–ª –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –≤–∏–Ω –ø–æ –≤–∞—à–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏." |
| Unknown intent | "–ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª –≤–∞—à –∑–∞–ø—Ä–æ—Å ü§î –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥." |
| Session expired | "–ù–∞—á–∏–Ω–∞—é –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥! –ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Å–µ–≥–æ–¥–Ω—è?" |

---

## Bot Description (BotFather)

**Name**: GetMyWine
**Username**: @getmywine_bot (example)

**About**:
```
üç∑ GetMyWine –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤–∏–Ω.

–ù–∞–∂–∏–º–∞—è /start, –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ –≤–∞–º –µ—Å—Ç—å 18 –ª–µ—Ç.
```

**Description**:
```
–ü—Ä–∏–≤–µ—Ç! –Ø GetMyWine üç∑

–Ø –ø–æ–º–æ–≥—É –≤–∞–º:
‚Ä¢ –ü–æ–¥–æ–±—Ä–∞—Ç—å –≤–∏–Ω–æ –ø–æ–¥ –±–ª—é–¥–æ –∏–ª–∏ —Å–æ–±—ã—Ç–∏–µ
‚Ä¢ –ù–∞–π—Ç–∏ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ –ø–æ –≤–∞—à–µ–º—É –≤–∫—É—Å—É
‚Ä¢ –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –º–∏—Ä–µ –≤–∏–Ω–∞

–ù–∞–∂–∏–º–∞—è /start, –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ –≤–∞–º –∏—Å–ø–æ–ª–Ω–∏–ª–æ—Å—å 18 –ª–µ—Ç.

–ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º: support@getmywine.ru
```

**Commands** (for BotFather /setcommands):
```
start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
help - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
profile - –í–∞—à –≤–∫—É—Å–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
link - –°–≤—è–∑–∞—Ç—å —Å –≤–µ–±-–∞–∫–∫–∞—É–Ω—Ç–æ–º
```
