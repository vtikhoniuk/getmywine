# Data Model: 012-split-wine-messages

**Date**: 2026-02-10

## Обзор

Фича не вводит новых сущностей и не изменяет схему БД. Все необходимые данные уже существуют в модели Wine.

## Существующие сущности (используемые)

### Wine

Используется для получения изображений и метаданных при формировании сообщений.

| Поле | Тип | Использование в фиче |
|------|-----|---------------------|
| `name` | String(255) | Отображается в caption, используется для извлечения вин из ответа LLM |
| `image_url` | String(500), nullable | Путь к изображению бутылки (`/static/images/wines/ID.png`) |
| `region` | String(255) | Caption: регион |
| `country` | String(100) | Caption: страна |
| `grape_varieties` | Array[String] | Caption: сорт винограда (первые 3) |
| `sweetness` | Enum(dry, semi_dry, semi_sweet, sweet) | Caption: тип вина |
| `price_rub` | Decimal(10,2) | Caption: цена в рублях |

### ParsedResponse (in-memory dataclass)

Структура для хранения разобранного ответа LLM. Не персистируется.

| Поле | Тип | Описание |
|------|-----|----------|
| `intro` | str | Текст вступительного сообщения |
| `wines` | list[str] | Тексты описания вин (до 3) |
| `closing` | str | Текст завершающего сообщения |
| `is_structured` | bool | True если intro и хотя бы 1 вино найдены |

## Миграции

Не требуются. Схема БД не изменяется.
